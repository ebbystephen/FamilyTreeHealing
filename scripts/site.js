
// Store emojis and associated text in a local variable
const emojis = [
    { emoji: "💒", text: "വിശ്വാസപ്രമാണം", content: "<b>വിശ്വാസപ്രമാണം</b><br /><br />സര്‍വ്വശക്തനായ പിതാവും ആകാശത്തിന്‍റെയും ഭൂമിയുടെയും സ്രഷ്ടാവുമായ ദൈവത്തില്‍ ഞാന്‍ വിശ്വസിക്കുന്നു. അവിടുത്തെ ഏകപുത്രനും ഞങ്ങളുടെ കര്‍ത്താവുമായ ഈസോമിശിഹായിലും ഞാന്‍ വിശ്വസിക്കുന്നു. ഈ പുത്രന്‍ പരിശുദ്ധാത്മാവാല്‍ ഗര്‍ഭസ്ഥനായി കന്യാമറിയത്തില്‍ നിന്നു പിറന്നു. പന്തിയോസ് പീലാത്തോസിന്‍റെ കാലത്ത് പീഡകള്‍ സഹിച്ച്, കുരിശില്‍ തറയ്ക്കപ്പെട്ട്, മരിച്ച് അടക്കപ്പെട്ടു; പാതാളത്തില്‍ ഇറങ്ങി, മരിച്ചവരുടെ ഇടയില്‍നിന്നു മൂന്നാം നാള്‍ ഉയിര്‍ത്തു; സ്വര്‍ഗ്ഗത്തിലെക്കെഴുന്നള്ളി, സര്‍വ്വശക്തിയുള്ള പിതാവായ ദൈവത്തിന്‍റെ വലതു ഭാഗത്ത് ഇരിക്കുന്നു; അവിടെനിന്ന് ജീവിക്കുന്നവരെയും മരിച്ചവരെയും വിധിക്കാന്‍ വരുമെന്നും ഞാന്‍ വിശ്വസിക്കുന്നു. പരിശുദ്ധാത്മാവിലും ഞാന്‍ വിശ്വസിക്കുന്നു. വിശുദ്ധ കത്തോലിക്കാ സഭയിലും, പുണ്യവാന്മാരുടെ ഐക്യത്തിലും, പാപങ്ങളുടെ മോചനത്തിലും, ശരീരത്തിന്‍റെ ഉയിര്‍പ്പിലും നിത്യമായ ജീവതത്തിലും ഞാന്‍ വിശ്വസിക്കുന്നു. ആമ്മേന്‍.<br />" },
    { emoji: "🌹", text: "എത്രയും ദയയുള്ള മാതാവേ", content: "" },
    { emoji: "📿", text: "ജപമാല", content: "" },
    { emoji: "❤‍🔥", text: "കരുണ കൊന്ത", content: "" },
    {
        emoji: "🤺", text: "മിഖായേല്‍ മാലാഖയോട്  പ്രാർത്ഥന", content: "<b>വി. മിഖായേല്‍ മാലാഖയോട് ഉള്ള പ്രാർത്ഥന</b><br /><br />മുഖ്യദൂതനായ വി.മിഖായേലേ, സ്വർഗ്ഗീയ സൈന്യങ്ങളുടെ പ്രതാപവാനായ പ്രഭോ, ഉന്നത ശക്തികളോടും, അധികാരങ്ങളോടും ഇരുളടഞ്ഞ  ഈ ലോകത്തിലെ ഭരണകർത്താക്കളോടും ഉപരിതലങ്ങളിലെ ദുരാത്മാക്കളോടുമുള്ള യുദ്ധത്തിൽ ഞങ്ങളെ സഹായിക്കണമേ. ദൈവം സ്വന്തം ഛായായിൽ സൃഷ്ടിക്കുകയും വലിയ വില കൊടുത്ത് വീണ്ടെടുക്കുകയും ചെയ്ത മനുഷ്യരെ പിശാചിന്റെ ക്രൂരഭരണത്തിൽ നിന്നും രക്ഷിക്കുവാൻ വരേണമേ.അങ്ങയെയാണല്ലോ തിരുസഭ തന്റെ പരിപാലകനും സംരക്ഷകനുമായി വണങ്ങുന്നത്. കർത്താവ്‌ രക്ഷിച്ച ആത്മാക്കളെ സ്വർഗ്ഗത്തിലേക്ക് കൂട്ടികൊണ്ടുപോകുവാൻ നിയുക്തനായിരിക്കുന്നത് അങ്ങ് തന്നെയാണല്ലോ. ആകയാൽ ഞങ്ങളുടെ പാദങ്ങളുടെ കീഴിൽ  പിശാചിനെ അടിമപ്പെടുത്തുവാൻ സമാധാനദാതാവയ ദൈവത്തോട് പ്രാർത്ഥിക്കണമേ. പിശാച് ഒരിക്കലും മനുഷ്യരെ കീഴ്പെടുത്തുകയോ തിരുസഭയെ ഉപദ്രവിക്കുകയോ ചെയ്യാതിരിക്കട്ടെ. കർത്താവിന്റെ കരുണ വേഗം ഞങ്ങളുടെമേൽ ഉണ്ടാകുന്നതിനായി ഞങ്ങളുടെ യാചനകൾ അത്യുന്നതന്റെ മുമ്പിൽ സമർപ്പിക്കണമേ. ദുഷ്ടജന്തുവും പഴയ സർപ്പവുമായ സാത്താനെയും അവന്റെ കൂട്ടുകാരെയും പിടിച്ചുകെട്ടി പാതാളത്തിൽ തള്ളി താഴ്ത്തണമേ. അവൻ മേലാലൊരിക്കലും ജനങ്ങളെ വഴി തെറ്റിക്കാതിരിക്കട്ടെ. ആമ്മേൻ. <br />"
    },
    { emoji: "👑", text: "പരിശുദ്ധ രാജ്ഞി", content: "" },
    {
        emoji: "➕", text: "വി. ജെര്‍ത്രൂദിനോട് ഉള്ള പ്രാർത്ഥന", content: "<b>വി. ജെര്‍ത്രൂദിനോട് ഉള്ള പ്രാര്‍ത്ഥന</b><br /><br />നിത്യപിതാവേ! അവിടുത്തെ പ്രിയപുത്രനും ഞങ്ങളുടെ ഏകകര്‍ത്താവുമായ യേശുക്രിസ്തുവിന്‍റെ തിരുരക്തം, ഇന്ന് ലോകമെമ്പാടും അര്‍പ്പിക്കപ്പെടുന്ന ദിവ്യബലികളോട് ചേര്‍ത്ത്, ശുദ്ധീകരണ സ്ഥലത്തിലെ എല്ലാ ശുദ്ധാത്മാക്കള്‍ക്കു വേണ്ടിയും ലോകം മുഴുവനിലുമുള്ള എല്ലാ പാപികള്‍ക്കു വേണ്ടിയും തിരുസഭയിലുള്ള എല്ലാ പാപികള്‍ക്കു വേണ്ടിയും എന്‍റെ കുടുംബത്തിലും തലമുറകളിലുള്ളവര്‍ക്കു വേണ്ടിയും ഞാന്‍ കാഴ്ച വയ്ക്കുന്നു.<br /> 1 സ്വര്‍ഗ്ഗ. 1 നന്മ. 1 ത്രിത്വ.<br />"
    },
    { emoji: "🚼", text: "കുരിശിന്റെ വഴി", content: "" },
    { emoji: "💓", text: "വി. കുര്‍ബാന", content: "" },
    {
        emoji: "🩸", text: "മാതാവിന്റെ രക്തകണ്ണീര്‍ ജപമാല", content: "<b>മാതാവിന്റെ രക്തക്കണ്ണുനീർ ജപമാല</b><br /><br />(പ്രചരിപ്പിക്കുന്നവരിലും ചൊല്ലുന്നവരിലും നിന്ന് പിശാച് തോറ്റ് ഓടിമറയുന്നു)<br />ക്രൂശിതനായ എൻ്റെ ഈശോയെ, അങ്ങേ തൃപ്പാദങ്ങളിൽ സാഷ്ടാംഗം വീണു കരുണാർദ്രമായ സ്നേഹത്തോടെ, കാൽവരിയിലേക്കുള്ള വേദന നിറഞ്ഞ യാത്രയിൽ അങ്ങേ അനുഗമിച്ച പരി.അമ്മയുടെ രക്തക്കണ്ണുനീരിനെ ഞങ്ങൾ അങ്ങേയ്ക്ക് സമർപ്പിക്കുന്നു. നല്ലവനായ കർത്താവേ, പരി.അമ്മയുടെ രക്തം കലർന്ന കണ്ണുനീർത്തുള്ളികൾ തരുന്ന സന്ദേശം ശരിക്കു മനസിലാക്കുന്നതിനും, അങ്ങനെ ഞങ്ങൾ ഇഹത്തിൽ അങ്ങയുടെ തിരുമനസ്സ് നിറവേറ്റിക്കൊണ്ട് സ്വർഗത്തിൽ അമ്മയോടൊത്ത് നിത്യമായി അങ്ങയെ വാഴ്ത്തി സ്‌തുതിക്കുന്നതിനും യോഗ്യരാകുന്നതിനുവേണ്ട അനുഗ്രഹം ഞങ്ങൾക്ക് നൽകണമേ. ആമ്മേൻ.<br /><br />(ജപമാലയുടെ വലിയ മണികളിൽ)<br />ഓ! ഈശോയെ, ഈ ലോകത്തിൽ അങ്ങയെ അധികമായി സ്നേഹിക്കുകയും സ്വർഗത്തിൽ അങ്ങയെ ഏറ്റം ഗാഢമായി സ്നേഹിച്ച് അങ്ങയോടൊത്ത് വാഴുകയും ചെയ്യുന്ന പരി.അമ്മയുടെ രക്തക്കണ്ണുനീർ കണങ്ങളെ അങ്ങു കരുണയോടെ വീക്ഷിക്കണമേ. (1 പ്രാവശ്യം)<br /><br />(ജപമാലയുടെ ചെറിയ മണികളിൽ)<br />സ്നേഹം നിറഞ്ഞ ഈശോയെ! അങ്ങയുടെ പരി.അമ്മ ചിന്തിയ രക്തക്കണ്ണുനീരിനെക്കുറിച്ച് ഞങ്ങളുടെ യാചനകൾ കേൾക്കണമേ. (7 പ്രാവശ്യം)<br /><br />വീണ്ടും ഓ ഈശോയെ.... (1 പ്രാവശ്യം)<br />സ്നേഹം നിറഞ്ഞ..... (7 പ്രാവശ്യം)<br />ഇങ്ങനെ 7 പ്രാവശ്യം ആവർത്തിക്കുക.<br /><br /><b>ജപമാല സമർപ്പണ പ്രാർത്ഥന</b><br />ഓ! മറിയമേ, വ്യാകുലവും, കരുണയും, സ്നേഹവും നിറഞ്ഞ അമ്മേ ഞങ്ങളുടെ എളിയ യാചനകളെ അങ്ങയുടെ പ്രാർത്ഥനയോടു ചേർത്ത് അങ്ങയുടെ പ്രിയപുത്രന് കാഴ്‌ചവയ്ക്കണമേ. അങ്ങു ഞങ്ങൾക്കായി ചിന്തിയ രക്തക്കണ്ണുനീർക്കണങ്ങളെക്കുറിച്ച് ഈ....... (ആവശ്യം പറയുക - നമ്മുടെ പൂര്‍വ്വ തലമുറയുടെ വിശുദ്ധികരണം) അങ്ങയുടെ പ്രിയ പുത്രനിൽ നിന്ന് ലഭിച്ചു തരണമെ. ഞങ്ങളെ എല്ലാവരെയും നിത്യഭാഗ്യത്തിൽ ചേർക്കുകയും ചെയ്യണമേ. ഓ! മറിയമേ! അങ്ങയുടെ രക്ത ക്കണ്ണീരാൽ പിശാചിൻ്റെ ഭരണത്തെ തകർക്കണമേയെന്നും ഞങ്ങളെപ്രതി ബന്ധിതമായ ഈശോയുടെ തൃക്കരങ്ങളാൽ സകല തിന്മകളിലും നിന്നും ലോകത്തെ കാത്തുരക്ഷിക്കണമേയെന്നും ഞങ്ങൾ പ്രാർത്ഥിക്കുന്നു. ആമ്മേൻ.<br />"
    },
    { emoji: "🕯️", text: "സമ്പൂര്‍ണ്ണ ജപമാല (4 രഹസ്യങ്ങള്‍- സന്തോഷം, ദുഃഖം, മഹിമ, പ്രകാശം)", content: "" },
    { emoji: "🛡️", text: "സങ്കീര്‍ത്തനങ്ങള്‍ 91", content: "<b>സങ്കീര്‍ത്തനങ്ങള്‍ 91</b> <br /><br /> <b>കര്‍ത്താവിന്റെ സംരക്ഷണം</b><br /> അത്യുന്നതന്റെ സംരക്ഷണത്തില്‍വസിക്കുന്നവനും, സര്‍വശക്തന്റെ തണലില്‍ കഴിയുന്നവനും, കര്‍ത്താവിനോട് എന്റെ സങ്കേതവും എന്റെ കോട്ടയും ഞാന്‍ ആശ്രയിക്കുന്ന എന്റെ ദൈവവും എന്നു പറയും. അവിടുന്നു നിന്നെ വേടന്റെ കെണിയില്‍നിന്നും മാരകമായ മഹാമാരിയില്‍നിന്നും രക്ഷിക്കും. തന്റെ തൂവലുകള്‍കൊണ്ട് അവിടുന്നു നിന്നെ മറച്ചുകൊള്ളും; അവിടുത്തെ ചിറകുകളുടെകീഴില്‍ നിനക്ക് അഭയംലഭിക്കും; അവിടുത്തെ വിശ്വസ്തത നിനക്കു കവചവും പരിചയും ആയിരിക്കും. രാത്രിയിലെ ഭീകരതയെയും പകല്‍ പറക്കുന്ന അസ്ത്രത്തെയും നീ ഭയപ്പെടേണ്ടാ. ഇരുട്ടില്‍ സഞ്ചരിക്കുന്ന മഹാമാരിയെയും നട്ടുച്ചയ്ക്കു വരുന്ന വിനാശത്തെയുംനീ പേടിക്കേണ്ടാ. നിന്റെ പാര്‍ശ്വങ്ങളില്‍ ആയിരങ്ങള്‍മരിച്ചുവീണേക്കാം; നിന്റെ വലത്തുവശത്തു പതിനായിരങ്ങളും; എങ്കിലും, നിനക്ക് ഒരനര്‍ഥവുംസംഭവിക്കുകയില്ല. ദുഷ്ടരുടെ പ്രതിഫലം നിന്റെ കണ്ണുകള്‍കൊണ്ടുതന്നെ നീ കാണും. നീ കര്‍ത്താവില്‍ ആശ്രയിച്ചു; അത്യുന്നതനില്‍ നീ വാസമുറപ്പിച്ചു. നിനക്ക് ഒരു തിന്‍മയും ഭവിക്കുകയില്ല; ഒരനര്‍ഥവും നിന്റെ കൂടാരത്തെസമീപിക്കുകയില്ല. നിന്റെ വഴികളില്‍ നിന്നെ കാത്തുപാലിക്കാന്‍ അവിടുന്നു തന്റെ ദൂതന്‍മാരോടു കല്‍പിക്കും. നിന്റെ പാദം കല്ലില്‍ തട്ടാതിരിക്കാന്‍ അവര്‍ നിന്നെ കൈകളില്‍ വഹിച്ചുകൊള്ളും. സിംഹത്തിന്റെയും അണലിയുടെയും മേല്‍ നീ ചവിട്ടിനടക്കും; യുവസിംഹത്തെയും സര്‍പ്പത്തെയും നീ ചവിട്ടി മെതിക്കും. അവന്‍ സ്‌നേഹത്തില്‍ എന്നോട് ഒട്ടിനില്‍ക്കുന്നതിനാല്‍ ഞാന്‍ അവനെ രക്ഷിക്കും; അവന്‍ എന്റെ നാമം അറിയുന്നതുകൊണ്ട് ഞാന്‍ അവനെ സംരക്ഷിക്കും. അവന്‍ എന്നെ വിളിച്ചപേക്ഷിക്കുമ്പോള്‍ ഞാന്‍ ഉത്തരമരുളും; അവന്റെ കഷ്ടതയില്‍ഞാന്‍ അവനോടു ചേര്‍ന്നുനില്‍ക്കും; ഞാന്‍ അവനെ മോചിപ്പിക്കുകയുംമഹത്വപ്പെടുത്തുകയും ചെയ്യും. ദീര്‍ഘായുസ്‌സു നല്‍കി ഞാന്‍ അവനെ സംതൃപ്തനാക്കും; എന്റെ രക്ഷ ഞാന്‍ അവനു കാണിച്ചുകൊടുക്കും. <br />" }
];

// Function to save to local storage

function saveToLocalStorage() {
    const emojiItems = document.querySelectorAll('.emoji-item input[type="text"]');
    const emojiCounts = {};
    emojiItems.forEach((item, index) => {
        emojiCounts[emojis[index].emoji] = item.value;
    });
    localStorage.setItem('emojiCounts', JSON.stringify(emojiCounts));
}

// Function to load from local storage
function loadFromLocalStorage() {
    const storedCounts = JSON.parse(localStorage.getItem('emojiCounts')) || {};
    const emojiItems = document.querySelectorAll('.emoji-item input[type="text"]');
    emojiItems.forEach((item, index) => {
        item.value = storedCounts[emojis[index].emoji] || 0;
    });
}

// Function to dynamically generate the form
function generateEmojiForm() {
    const form = document.getElementById('emojiForm');
    emojis.forEach((item, index) => {
        const emojiDiv = document.createElement('div');
        emojiDiv.classList.add('emoji-item');

        // Create label for emoji and text
        const label = document.createElement('label');
        label.textContent = `${item.emoji} ${item.text}`;

        if (item.content != "") {
            label.classList.add('clickable');
            label.onclick = function () {
                showPopup(item.content);
            };
        }

        // Create - button
        const minusButton = document.createElement('button');
        minusButton.type = 'button';
        minusButton.textContent = '-';
        minusButton.onclick = function () {
            const countInput = document.getElementById(`count${index}`);
            let currentValue = parseInt(countInput.value);
            if (currentValue > 0) {
                countInput.value = currentValue - 1;
                saveToLocalStorage();
            }
        };

        // Create number input (readonly)
        const numberInput = document.createElement('input');
        numberInput.type = 'text';
        numberInput.value = 0;
        numberInput.readOnly = true;
        numberInput.id = `count${index}`;

        // Create + button
        const plusButton = document.createElement('button');
        plusButton.type = 'button';
        plusButton.textContent = '+';
        plusButton.onclick = function () {
            const countInput = document.getElementById(`count${index}`);
            let currentValue = parseInt(countInput.value);
            countInput.value = currentValue + 1;
            saveToLocalStorage();
        };

        // Append elements to the emojiDiv
        emojiDiv.appendChild(label);
        emojiDiv.appendChild(minusButton);
        emojiDiv.appendChild(numberInput);
        emojiDiv.appendChild(plusButton);

        // Append emojiDiv to the form
        form.appendChild(emojiDiv);
    });

    // Load stored values after generating the form
    loadFromLocalStorage();
}

function showPopup(content) {
    const popup = document.createElement('div');
    popup.classList.add('popup');

    // Create content container
    const contentContainer = document.createElement('div');
    contentContainer.classList.add('popup-content');
    contentContainer.innerHTML = content;

    // Create a close button
    const closeButton = document.createElement('button');
    closeButton.textContent = 'Close';
    closeButton.onclick = function () {
        document.body.removeChild(popup);
    };

    // Add the close button to the content container
    contentContainer.appendChild(closeButton);

    // Add the close button to the popup
    popup.appendChild(contentContainer);

    // Append popup to body
    document.body.appendChild(popup);
}

// Call the function to generate the form
generateEmojiForm();

document.getElementById('submitBtn').addEventListener('click', function () {
    // Get all emoji items
    const emojiItems = document.querySelectorAll('.emoji-item input[type="text"]');
    let resultMessage = '';

    // Loop through each emoji item
    emojiItems.forEach((item, index) => {
        const count = parseInt(item.value);
        const emoji = emojis[index].emoji;

        // If count is greater than 0, append the emoji to the message
        if (count > 0) {
            for (let i = 0; i < count; i++) {
                resultMessage += emoji;
            }
        }
    });

    //alert(resultMessage);

    const phoneNumber = localStorage.getItem('whatsappNumber');
    // Check if the phone number is null or empty
    if (!phoneNumber || phoneNumber.trim() === "") {
        alert("Please update your WhatsApp number to post the message.");
    } else {
        // Post the result message to WhatsApp
        const whatsappMessage = encodeURIComponent(resultMessage);
        const whatsappGroupLink = `https://wa.me/${phoneNumber}?text=${whatsappMessage}`;
        window.open(whatsappGroupLink, '_blank');
    }
    // Display the result
    document.getElementById('result').textContent = `Done with: ${resultMessage}`;
    document.getElementById('copyButton').style.display = 'block';

    // Automatically reset the form after posting the message
    //setTimeout(function () {
    //    document.getElementById('resetBtn').click();
    //}, 500); // Delay to ensure the WhatsApp link is opened before resetting
});

// Reset button event handler
document.getElementById('resetBtn').addEventListener('click', function () {
    if (confirm("Are you sure you want to reset all values to 0?")) {
        const emojiItems = document.querySelectorAll('.emoji-item input[type="text"]');
        emojiItems.forEach((item) => {
            item.value = 0;
        });
        document.getElementById('result').textContent = "";
        document.getElementById('copyButton').style.display = 'none';
        saveToLocalStorage();
    }
});


// Function to show the popup
function showPhonePopup() {
    const phpopup = document.createElement('div');
    phpopup.classList.add('ph-popup');

    const contentContainer = document.createElement('div');
    contentContainer.classList.add('ph-popup-content');

    contentContainer.innerHTML = `
                <h2>Update Your WhatsApp Number</h2>
                <p>This number will be used to post the completed prayer list to your WhatsApp number.</p>
                <input type="text" id="phoneNumber" placeholder="Enter WhatsApp number (+919876543210)" value="${getPhoneNumber()}">
                <button class="btn-save" onclick="savePhoneNumber()">Save</button>
                <button class="btn-skip" onclick="skipPhonePopup()">Skip</button>
            `;

    phpopup.appendChild(contentContainer);
    document.body.appendChild(phpopup);
}

// Function to save phone number to local storage
function savePhoneNumber() {
    const phoneNumber = document.getElementById('phoneNumber').value.trim();
    if (phoneNumber) {
        localStorage.setItem('whatsappNumber', phoneNumber);
        closePhonePopup();
    } else {
        alert('Please enter a valid phone number.');
    }
}

// Function to skip the popup and go to the main page
function skipPhonePopup() {
    closePhonePopup();
}

// Function to close the popup
function closePhonePopup() {
    const phpopup = document.querySelector('.ph-popup');
    if (phpopup) {
        phpopup.remove();
    }
}

// Function to get phone number from local storage
function getPhoneNumber() {
    return localStorage.getItem('whatsappNumber') || '';
}

// Show popup on page load if the phone number is not set
/*
window.onload = function () {
    if (!getPhoneNumber()) {
        showPhonePopup();
    }
};
*/

// Show popup when the phone icon is clicked
document.getElementById('phoneIcon').onclick = function () {
    showPhonePopup();
};


document.getElementById('copyButton').onclick = function () {
    const resultDiv = document.getElementById('result');
    const content = resultDiv.textContent || resultDiv.innerText;

    // Create a temporary textarea element
    const tempTextArea = document.createElement('textarea');
    tempTextArea.value = content.replace('Done with: ', '');
    document.body.appendChild(tempTextArea);

    // Select the text and copy it to the clipboard
    tempTextArea.select();
    document.execCommand('copy');

    // Remove the temporary textarea
    document.body.removeChild(tempTextArea);

    // Optional: Give feedback to the user
    //alert('Copied to clipboard');
};

